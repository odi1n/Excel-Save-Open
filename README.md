# Excel - save, open file .xlsx

Пример сохранения и открытия файла .xlsx на двух библиотеках

### В примере используются:
#### [EPPLus](https://github.com/odi1n/Excel-Save-Open#epplus) - открытие, сохранение.
#### [ClosedXML.Excel](https://github.com/odi1n/Excel-Save-Open#closedxmlexcel) - открытие, сохранение.
#### [LinqToExcel](https://github.com/odi1n/Excel-Save-Open#LinqToExcel) - открытие.

### EPPLus
Имеется: 
* [Сохранение файла](https://github.com/odi1n/Excel-Save-Open/blob/51510fe4fb6d330e9566ba549693cd5aac11c465/Test%20Excel/Program.cs#L192)
* [Открытие файла](https://github.com/odi1n/Excel-Save-Open/blob/51510fe4fb6d330e9566ba549693cd5aac11c465/Test%20Excel/Program.cs#L181)

Удобная в плане того что файл можно редактировать любым удобным для вас способом. Много варианто работы с формированием файла.
При открытии/сохранение файла в 500к строк, употребляет память, но не сильно 200-400мб, после открытия файла очищает память что очень радует.

### ClosedXML.Excel
Имеется:
* [Сохранение файла](https://github.com/odi1n/Excel-Save-Open/blob/d7499043fd6225d0752b5d91bdf0c29261b4589a/Test%20Excel/Program.cs#L157)
* [Открытие файла](https://github.com/odi1n/Excel-Save-Open/blob/d7499043fd6225d0752b5d91bdf0c29261b4589a/Test%20Excel/Program.cs#L101)

Удобная в плане того что файл можно редактировать любым удобным для вас способом. Много варианто работы с формированием файла.
Плоха тем что при открытие/сохранение файла в 500к строк идет большая нагрузка на моем примере 1-2к гб, после открытия можно очистить память.

### LinqToExcel
Имеется:
* [Открытие файла](https://github.com/odi1n/Excel-Save-Open/blob/d7499043fd6225d0752b5d91bdf0c29261b4589a/Test%20Excel/Program.cs#L79)

Хороша тем что можно сразу открыть в List без каких либо переборов в цикле. Нет нагрузки при открытие файла.
Не имеет возможности делать сохранения файла

## Выводы
Для меня главный было что бы можно было сохранить/открыть Список в/из excel без перебора в цикле. Размер списка был 500к строк, то есть на выходе должен получить excel файл с 500к строками.

|Место|Библиотека|
|:---:|:---:|
|1|EPPLus|
|2|LinqToExcel|
|3|ClosedXML.Excel|

По результатам личных наблюдений и тестов я расположил их в следующем порядке:
1. EPPLus - по моему мнению оказалась лучшей, так как она адекватно употребляет память, так же ее очищает, можно любым образом форматировать файл.
2. LinqToExcel -  имеет большой недостаток это то что не может сохранять файл, открытие файла работает очень быстро.
3. ClosedXML.Excel - расположил ее 3й так как плохо работает с памятью, есть ее очень сильно, имеет так же возможность юбым образом форматировать файл.
